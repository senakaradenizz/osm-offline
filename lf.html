<!DOCTYPE HTML>
<html lang="en">
  <head>
    <title>Offline Map of Turkey with Leaflet</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>
    <style>
      html, 
      body,
      #map {
        /* configure the size of the map */
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <div id="map" class="map"></div>
    <script>
      // initialize Leaflet
      var map = L.map('map').setView([39.925533, 32.866287], 6);

      // add the OpenStreetMap tiles
      // Set up the OSM layer
      L.tileLayer(
      'http://localhost/hot/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://openstreetmap.org/copyright">OpenStreetMap contributors</a>'
      }).addTo(map);

      // show the scale bar on the lower left corner
      L.control.scale().addTo(map);
      // JSON file
      locations = [
            {
              "latitude": 41.915,
              "longitude": 42.71
            },
            {
              "latitude": 38.259,
              "longitude": 35.503
            },
            {
              "latitude": 41.682,
              "longitude": 28.257
            },
            {
              "latitude": 38.464,
              "longitude": 38.534
            },
            {
              "latitude": 41.46,
              "longitude": 31.143
            },
            {
              "latitude": 41.829,
              "longitude": 41.295
            },
            {
              "latitude": 39.705,
              "longitude": 38.57
            },
            {
              "latitude": 38.758,
              "longitude": 34.683
            },
            {
              "latitude": 37.377,
              "longitude": 27.02
            },
            {
              "latitude": 38.491,
              "longitude": 36.392
            },
            {
              "latitude": 41.418,
              "longitude": 27.715
            },
            {
              "latitude": 38.225,
              "longitude": 29.36
            },
            {
              "latitude": 36.014,
              "longitude": 32.172
            },
            {
              "latitude": 41.117,
              "longitude": 35.973
            },
            {
              "latitude": 41.374,
              "longitude": 27.467
            },
            {
              "latitude": 36.746,
              "longitude": 38.603
            },
            {
              "latitude": 38.68,
              "longitude": 36.07
            },
            {
              "latitude": 38.662,
              "longitude": 28.361
            },
            {
              "latitude": 41.905,
              "longitude": 41.391
            },
            {
              "latitude": 38.69,
              "longitude": 35.025
            },
            {
              "latitude": 41.589,
              "longitude": 26.418
            },
            {
              "latitude": 40.08,
              "longitude": 35.055
            },
            {
              "latitude": 37.012,
              "longitude": 32.583
            },
            {
              "latitude": 41.696,
              "longitude": 44.68
            },
            {
              "latitude": 38.077,
              "longitude": 29.49
            },
            {
              "latitude": 39.279,
              "longitude": 35.853
            },
            {
              "latitude": 38.447,
              "longitude": 29.907
            },
            {
              "latitude": 37.475,
              "longitude": 32.904
            },
            {
              "latitude": 37.388,
              "longitude": 39.173
            },
            {
              "latitude": 37.758,
              "longitude": 42.201
            },
            {
              "latitude": 36.856,
              "longitude": 36.636
            },
            {
              "latitude": 39.916,
              "longitude": 26.366
            },
            {
              "latitude": 40.355,
              "longitude": 36.211
            },
            {
              "latitude": 38.226,
              "longitude": 43.147
            },
            {
              "latitude": 41.057,
              "longitude": 30.388
            },
            {
              "latitude": 41.512,
              "longitude": 36.287
            },
            {
              "latitude": 39.4,
              "longitude": 30.336
            },
            {
              "latitude": 39.966,
              "longitude": 38.61
            },
            {
              "latitude": 36.507,
              "longitude": 28.893
            },
            {
              "latitude": 37.104,
              "longitude": 42.319
            },
            {
              "latitude": 39.215,
              "longitude": 30.698
            },
            {
              "latitude": 38.158,
              "longitude": 43.315
            },
            {
              "latitude": 37.295,
              "longitude": 34.453
            },
            {
              "latitude": 36.487,
              "longitude": 33.126
            },
            {
              "latitude": 38.225,
              "longitude": 31.177
            },
            {
              "latitude": 37.911,
              "longitude": 28.925
            },
            {
              "latitude": 38.487,
              "longitude": 42.204
            },
            {
              "latitude": 38.082,
              "longitude": 43.973
            },
            {
              "latitude": 40.805,
              "longitude": 42.078
            },
            {
              "latitude": 39.868,
              "longitude": 39.597
            },
            {
              "latitude": 40.661,
              "longitude": 42.682
            },
            {
              "latitude": 40.805,
              "longitude": 36.505
            },
            {
              "latitude": 37.481,
              "longitude": 32.375
            },
            {
              "latitude": 41.513,
              "longitude": 32.397
            },
            {
              "latitude": 37.094,
              "longitude": 43.545
            },
            {
              "latitude": 39.869,
              "longitude": 30.853
            },
            {
              "latitude": 39.757,
              "longitude": 31.607
            },
            {
              "latitude": 36.332,
              "longitude": 42.437
            },
            {
              "latitude": 37.529,
              "longitude": 33.25
            },
            {
              "latitude": 37.052,
              "longitude": 38.906
            },
            {
              "latitude": 39.764,
              "longitude": 30.365
            },
            {
              "latitude": 39.513,
              "longitude": 36.94
            },
            {
              "latitude": 36.509,
              "longitude": 37.547
            },
            {
              "latitude": 38.888,
              "longitude": 38.745
            },
            {
              "latitude": 37.53,
              "longitude": 38.265
            },
            {
              "latitude": 40.491,
              "longitude": 27.558
            },
            {
              "latitude": 38.061,
              "longitude": 41.2
            },
            {
              "latitude": 37.827,
              "longitude": 31.187
            },
            {
              "latitude": 36.378,
              "longitude": 34.255
            },
            {
              "latitude": 41.903,
              "longitude": 28.527
            },
            {
              "latitude": 40.171,
              "longitude": 26.676
            },
            {
              "latitude": 37.943,
              "longitude": 42.238
            },
            {
              "latitude": 36.497,
              "longitude": 26.229
            },
            {
              "latitude": 37.25,
              "longitude": 31.186
            },
            {
              "latitude": 37.937,
              "longitude": 36.064
            },
            {
              "latitude": 41.662,
              "longitude": 40.243
            },
            {
              "latitude": 39.207,
              "longitude": 43.554
            },
            {
              "latitude": 37.476,
              "longitude": 39.903
            },
            {
              "latitude": 39.395,
              "longitude": 34.571
            },
            {
              "latitude": 38.92,
              "longitude": 33.54
            },
            {
              "latitude": 39.115,
              "longitude": 29.068
            },
            {
              "latitude": 40.253,
              "longitude": 35.909
            },
            {
              "latitude": 41.393,
              "longitude": 43.351
            },
            {
              "latitude": 37.285,
              "longitude": 38.138
            },
            {
              "latitude": 39.218,
              "longitude": 28.971
            },
            {
              "latitude": 36.453,
              "longitude": 29.297
            },
            {
              "latitude": 41.857,
              "longitude": 39.71
            },
            {
              "latitude": 38.243,
              "longitude": 26.267
            },
            {
              "latitude": 39.451,
              "longitude": 44.536
            },
            {
              "latitude": 37.953,
              "longitude": 41.425
            },
            {
              "latitude": 36.267,
              "longitude": 33.379
            },
            {
              "latitude": 38.719,
              "longitude": 26.258
            },
            {
              "latitude": 37.872,
              "longitude": 33.156
            },
            {
              "latitude": 36.862,
              "longitude": 26.63
            },
            {
              "latitude": 38.068,
              "longitude": 43.126
            },
            {
              "latitude": 41.431,
              "longitude": 28.601
            },
            {
              "latitude": 36.188,
              "longitude": 36.393
            },
            {
              "latitude": 39.017,
              "longitude": 44.947
            },
            {
              "latitude": 39.422,
              "longitude": 26.472
            }
          ]

      var markerArr = new Array();
      map.on('zoomend', function() {
        var bounds = map.getBounds(); 
        var northEastLat = bounds._northEast.lat;
        var northEastLng = bounds._northEast.lng;
        var southWestLat = bounds._southWest.lat;
        var southWestLng = bounds._southWest.lng;
        for (var i = 0; i < locations.length; i++) {
          var lat = locations[i].latitude;
          var lng = locations[i].longitude;
          latAndLng = [lat, lng];
          var marker = new L.marker(latAndLng);
          //console.log(marker);
          markerArr.push(marker);
          // show a marker on the map
          if(markerArr[i]._latlng.lat < northEastLat && markerArr[i]._latlng.lat > southWestLat && markerArr[i]._latlng.lng < northEastLng && markerArr[i]._latlng.lng > southWestLng) {
            
            map.addLayer(markerArr[i]);
            //console.log("if")
          } else {
            //console.log("else")
            map.removeLayer(markerArr[i]);
          }
          
        }
     })
      map.on('dragend', function() {
        var bounds = map.getBounds(); 
        var northEastLat = bounds._northEast.lat;
        var northEastLng = bounds._northEast.lng;
        var southWestLat = bounds._southWest.lat;
        var southWestLng = bounds._southWest.lng;
        for (var i = 0; i < locations.length; i++) {
          var lat = locations[i].latitude;
          var lng = locations[i].longitude;
          latAndLng = [lat, lng];
          var marker = new L.marker(latAndLng);
          //console.log(marker);
          markerArr.push(marker);
          // show a marker on the map
          if(markerArr[i]._latlng.lat < northEastLat && markerArr[i]._latlng.lat > southWestLat && markerArr[i]._latlng.lng < northEastLng && markerArr[i]._latlng.lng > southWestLng) {
                
            map.addLayer(markerArr[i]);
            //console.log("if")
          } else {
            //console.log("else")
            map.removeLayer(markerArr[i]);
          }
              
        }
     })
      
    </script>
  </body>
</html>